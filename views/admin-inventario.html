<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inventario - Administrador</title>
    <link rel="stylesheet" href="/css/styles.css">
</head>
<body>
    <div class="container">
        <header class="admin-header">
            <div class="header-content">
                <div class="header-info">
                    <h1>üì¶ Gesti√≥n de Inventario</h1>
                    <p id="welcomeMessage">Sistema de Administraci√≥n de Llantas</p>
                </div>
                <div class="header-actions">
                    <span class="user-badge admin">üëë Admin</span>
                    <button onclick="logout()" class="btn-logout">Cerrar Sesi√≥n</button>
                </div>
            </div>
        </header>

        <main class="admin-main">
            <!-- Navegaci√≥n por tabs -->
            <div class="admin-tabs">
                <button class="tab-btn" onclick="irADashboard()">üìã Solicitudes</button>
                <button class="tab-btn" onclick="irAEmpleados()">üë• Empleados</button>
                <button class="tab-btn" onclick="irAReportes()">üìä Reportes</button>
                <button class="tab-btn" onclick="irAConfiguracion()">‚öôÔ∏è Configuraci√≥n</button>
                <button class="tab-btn" onclick="irACotizaciones()">üí∞ Cotizaciones</button>
                <button class="tab-btn active" onclick="irAInventario()">üì¶ Inventario</button>
            </div>
            <!-- Dashboard de m√©tricas -->
            <div class="inventory-dashboard">
                <div class="metrics-grid">
                    <div class="metric-card">
                        <div class="metric-icon">üõû</div>
                        <div class="metric-info">
                            <h3 id="total-productos">0</h3>
                            <p>Total Productos</p>
                        </div>
                    </div>
                    <div class="metric-card warning">
                        <div class="metric-icon">‚ö†Ô∏è</div>
                        <div class="metric-info">
                            <h3 id="stock-bajo">0</h3>
                            <p>Stock Bajo</p>
                        </div>
                    </div>
                    <div class="metric-card success">
                        <div class="metric-icon">üí∞</div>
                        <div class="metric-info">
                            <h3 id="valor-inventario">$0</h3>
                            <p>Valor Inventario</p>
                        </div>
                    </div>
                    <div class="metric-card info">
                        <div class="metric-icon">üìà</div>
                        <div class="metric-info">
                            <h3 id="productos-activos">0</h3>
                            <p>Productos Activos</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Controles de la tabla -->
            <div class="inventory-controls">
                <div class="controls-left">
                    <button onclick="mostrarFormularioNuevo()" class="btn btn-success">
                        ‚ûï Nuevo Producto
                    </button>
                    <button onclick="mostrarImportacionMasiva()" class="btn btn-info">
                        üì• Importar Productos
                    </button>
                    <button onclick="exportarInventario()" class="btn btn-secondary">
                        üìä Exportar Excel
                    </button>
                    <a href="/admin/movimientos" class="btn btn-primary">
                        üìä Ver Movimientos
                    </a>
                    <a href="/admin/reservas" class="btn btn-warning">
                        üîí Ver Reservas
                    </a>
                </div>
                <div class="controls-right">
                    <div class="view-toggle">
                        <button id="btn-vista-tarjetas" onclick="cambiarVista('cards')" class="btn btn-outline-primary btn-sm active">
                            üî≤ Tarjetas
                        </button>
                        <button id="btn-vista-tabla" onclick="cambiarVista('table')" class="btn btn-outline-primary btn-sm">
                            üìã Tabla
                        </button>
                    </div>
                    <div class="search-container">
                        <input type="text" id="buscar-producto" placeholder="Buscar por marca, modelo, medida..." class="search-input">
                        <button onclick="limpiarBusqueda()" class="btn btn-secondary btn-sm">Limpiar</button>
                    </div>
                    <select id="filtro-stock" class="filter-select">
                        <option value="">Todos los productos</option>
                        <option value="disponible">Solo disponibles</option>
                        <option value="bajo">Stock bajo</option>
                        <option value="agotado">Agotados</option>
                    </select>
                </div>
            </div>

            <!-- Vista de productos -->
            <div class="inventory-container">
                <div class="loading" id="loading-productos">
                    <div class="spinner"></div>
                    <p>Cargando inventario...</p>
                </div>
                
                <!-- Vista de tarjetas -->
                <div id="vista-tarjetas" class="products-grid" style="display: none;">
                    <!-- Las tarjetas se cargar√°n aqu√≠ din√°micamente -->
                </div>

                <!-- Vista de tabla compacta -->
                <div id="vista-tabla" class="inventory-table-container" style="display: none;">
                    <table class="inventory-table compact">
                        <thead>
                            <tr>
                                <th class="sortable" onclick="ordenarPor('producto')">Producto</th>
                                <th class="sortable" onclick="ordenarPor('ubicacion')">Ubicaci√≥n</th>
                                <th class="sortable" onclick="ordenarPor('stock')">Stock</th>
                                <th class="sortable" onclick="ordenarPor('precio')">Precio</th>
                                <th class="sortable" onclick="ordenarPor('estado')">Estado</th>
                                <th class="actions-column">Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="tabla-productos">
                            <!-- Los productos se cargar√°n aqu√≠ din√°micamente -->
                        </tbody>
                    </table>
                </div>

                <div id="no-productos" style="display: none;" class="empty-state">
                    <div class="empty-icon">üõû</div>
                    <h3>No hay productos en el inventario</h3>
                    <p>Comienza agregando tu primer producto al inventario</p>
                    <button onclick="mostrarFormularioNuevo()" class="btn btn-primary">
                        ‚ûï Agregar Primer Producto
                    </button>
                </div>
            </div>

            <!-- Paginaci√≥n -->
            <div id="paginacion" class="pagination-container" style="display: none;">
                <div class="pagination-info">
                    <span id="info-paginacion">Mostrando 1-10 de 50 productos</span>
                </div>
                <div class="pagination-controls">
                    <button id="btn-anterior" class="btn btn-secondary btn-sm">‚Üê Anterior</button>
                    <span id="paginas-numeros" class="page-numbers"></span>
                    <button id="btn-siguiente" class="btn btn-secondary btn-sm">Siguiente ‚Üí</button>
                </div>
            </div>
            </div>

        </main>

        <footer>
            <!-- Footer generado autom√°ticamente -->
        </footer>
    </div>

    <!-- Modal para nuevo/editar producto -->
    <div id="modal-producto" class="modal hidden">
        <div class="modal-content large">
            <h3 id="titulo-modal">Nuevo Producto</h3>
            <div id="form-producto-errors" class="form-errors hidden"></div>
            <form id="form-producto">
                <input type="hidden" id="producto-id">
                
                <div class="form-grid">
                    <div class="form-group">
                        <label for="producto-marca">Marca*</label>
                        <input type="text" id="producto-marca" name="marca" required 
                               placeholder="ej: Michelin, Bridgestone">
                    </div>

                    <div class="form-group">
                        <label for="producto-modelo">Modelo*</label>
                        <input type="text" id="producto-modelo" name="modelo" required 
                               placeholder="ej: Energy Saver, Turanza">
                    </div>

                    <div class="form-group">
                        <label for="producto-medida">Medida*</label>
                        <input type="text" id="producto-medida" name="medida" required 
                               placeholder="ej: 205/55R16" pattern="[0-9]+/[0-9]+R[0-9]+">
                        <small>Formato: ancho/serie/rin (ej: 205/55R16)</small>
                    </div>

                    <div class="form-group">
                        <label for="producto-precio-compra">Precio Compra</label>
                        <input type="number" id="producto-precio-compra" name="precio_compra" 
                               min="0" step="0.01" placeholder="150000">
                    </div>

                    <div class="form-group">
                        <label for="producto-precio-venta">Precio Venta*</label>
                        <input type="number" id="producto-precio-venta" name="precio_venta" 
                               required min="0" step="0.01" placeholder="250000">
                    </div>

                    <div class="form-group">
                        <label for="producto-stock">Stock Actual*</label>
                        <input type="number" id="producto-stock" name="stock_actual" 
                               required min="0" value="0">
                    </div>

                    <div class="form-group">
                        <label for="producto-stock-minimo">Stock M√≠nimo*</label>
                        <input type="number" id="producto-stock-minimo" name="stock_minimo" 
                               required min="0" value="5">
                    </div>

                    <div class="form-group">
                        <label for="producto-proveedor">Proveedor</label>
                        <input type="text" id="producto-proveedor" name="proveedor" 
                               placeholder="Nombre del proveedor">
                    </div>

                    <div class="form-group">
                        <label for="producto-codigo-barras">C√≥digo de Barras</label>
                        <div class="barcode-container">
                            <input type="text" id="producto-codigo-barras" name="codigo_barras" 
                                   placeholder="C√≥digo de barras (se genera autom√°tico si est√° vac√≠o)">
                            <button type="button" onclick="generarCodigoBarras()" class="btn btn-secondary btn-sm">
                                üî¢ Generar
                            </button>
                        </div>
                        <small>Si est√° vac√≠o, se generar√° autom√°ticamente basado en marca, modelo y medida</small>
                    </div>

                    <div class="form-group">
                        <label for="producto-ubicacion">Ubicaci√≥n en Almac√©n</label>
                        <select id="producto-ubicacion" name="ubicacion_almacen">
                            <option value="">Seleccionar ubicaci√≥n</option>
                            <option value="A1">Estante A1 - Llantas 13-15"</option>
                            <option value="A2">Estante A2 - Llantas 16-17"</option>
                            <option value="A3">Estante A3 - Llantas 18+"</option>
                            <option value="B1">√Årea B1 - Llantas Deportivas</option>
                            <option value="B2">√Årea B2 - Llantas Camioneta</option>
                            <option value="C1">Dep√≥sito C1 - Stock Reserva</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="producto-lote">N√∫mero de Lote</label>
                        <input type="text" id="producto-lote" name="numero_lote" 
                               placeholder="Ej: L2024001">
                    </div>

                    <div class="form-group">
                        <label for="producto-fecha-ingreso">Fecha de Ingreso</label>
                        <input type="date" id="producto-fecha-ingreso" name="fecha_ingreso">
                    </div>
                </div>

                <div class="form-group">
                    <label for="producto-descripcion">Descripci√≥n</label>
                    <textarea id="producto-descripcion" name="descripcion" rows="3" 
                              placeholder="Caracter√≠sticas t√©cnicas, beneficios..."></textarea>
                </div>

                <div class="form-group">
                    <label for="producto-imagen">Imagen del Producto</label>
                    <div class="imagen-upload-container">
                        <input type="file" id="producto-imagen-file" accept="image/*" style="display: none;">
                        <input type="url" id="producto-imagen" name="imagen_url" 
                               placeholder="https://llanteramovil.com/wp-content/uploads/elementor/thumbs/llanta-5-pr0al2r4eqji54wsuj231nsld0ryo0qbwlru1zf280.png" value="https://llanteramovil.com/wp-content/uploads/elementor/thumbs/llanta-5-pr0al2r4eqji54wsuj231nsld0ryo0qbwlru1zf280.png">
                        <div class="upload-buttons">
                            <button type="button" onclick="abrirSeleccionArchivo()" class="btn btn-secondary btn-sm">
                                üìÅ Subir Imagen
                            </button>
                            <button type="button" id="btn-vista-previa" onclick="mostrarVistaPrevia()" class="btn btn-info btn-sm">
                                üëÅÔ∏è Vista Previa
                            </button>
                        </div>
                    </div>
                    <div id="imagen-preview" class="imagen-preview" style="display: none;">
                        <img id="preview-img" src="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAkGBxMTEhUTExMSFRUXFx0aGRcYGBcaGBgiGhYeGRgdGBgZHSggHhsmHhgaIjEhJSkrLi4uHSAzODMtNygtLisBCgoKDQ0ODg0NDisZHxk3KysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrK//AABEIAOsA1gMBIgACEQEDEQH/xAAcAAEAAAcBAAAAAAAAAAAAAAAAAQIDBAUGBwj/xABLEAABAwIDBAYGBggDBgcBAAABAAIRAwQSITEFQVFhBgcTInGBMlKRobHBQmJyktHwFCMzgqKy4fEkU8IlNHOTs9MWVGNkg8PSCP/EABUBAQEAAAAAAAAAAAAAAAAAAAAB/8QAFBEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEQMRAD8A7iiIgIiICIiAiIgIiICIiAiIgIiICIiAiIgIiICIiAiIgIiICIiAiIgIiICIiAixu3Nu0LRmOvUDRubq532WjM/Bco6SdaleoS22w0G7iYNQ66k5N3aAnmg7LXrtYMT3Na0b3EAe0rBXXTjZ9Mw67ok/UJf/ACArz3f7UqVXYqr6lQ+s5xcfeZjkFZ9vO+eXDxQegX9Z+yxrckeNGuPjTUR1mbL/APMn/lV//wALz32kbyOTQPz8FbVGEyWgtdzdkfEAoPTll022dVMMvKGL1XPDHfdfBWeY8EAggg6EZgryM2ri1BBHCDHgfSV9sbpBcWrgKNepTcdMBOB32qfoz4hB6tRcW2B1xVmEMvKTav1qXdflGeEnCdeLV1TYHSK2vGF9vVa+PSbo9nJ7TmPgdyDKoiICIiAiIgIiICIiAiIgIiICIiAtR6ddOKVg3A2Klw4S2nubwdUjRvAan2kX/TbpKywtnViA6oe7SYT6byMh9kak8AeS89v7W4qPqVHF1R7sT3neT8twG4ADQIG1NpVbmo6rXeXvdvPwA3DkMlaBo4BZqlYNA0BPNRdaiM2tPhl70GCNMeB5fNW9WmZ4HcRv/HzWZr2G9s/ZOvlx/OqsXskQf7ILKm+MoOLeOPMngouaT9Mj7IEe/VS1mnhmPf4+Kp5HvOMjnk0eXFBJctAl7XZgQcwZA5cVVcMTRIDgRIIyI5jn5hQ7Rm5pz4MMaeCoW4Ae4S5u9uceORy8kFe1qEgh2bmO8Dkcj5q+2LtKtReK1Ko5lZkicss5gje05ZGRyWPuw5pa/SDBcNIPrBT3jMwSAWyMXwBjgCUHojq+6esvmCnVw07kDNv0akalmZ82yY4kZrdV5HZVDKgc0kFmctBBZGha4ei4cQu/9WnTgXzOxrd24YJzECq3TGIyxcQOR0MAN5REQEREBERAREQEREBERAQotP61dtm22e8MMVK5FFnHvg4yOBDA4g8YQco6Z7eO0L1z2maNMmnRG6Ae/U/eInwDeCp06YaICsdm0gxvlHkqlzcoKtS4AVIXSk2Ts6tdVOzotk6uJya0cXHct1o9B7SlH6TcnEd2NlMeQMkoNSFQO5HceCtNoW2WIef4/n5rebvoA1zcdpXxfVeWkO8KjYg+I8wtSrMcwup1Glrm5OaciPzx80Gs3Tcp4a+H5+Ssw2DnHEE7uMDTesrd0sJWMe3DpEtM+X9vggqsrmO6x7uZgfGFQvSXNDjTcA0yZg5b9D8VdMrAbnv+y0x5HT3qf9LmQaVUZcPjCCWlTDgcLgWnIiZGfDe08tFT2cwljmknE0wQYMcPJS7MY1zcJhr2kjLuv115+BEKetRLazHPOThhxDKSMxiExoIQQoEtBYWy4O3ZA75J4Zq/2JtCtQrMdSc1j6ZxNyJB4iZGWcEcCre6plrxUkkei4cN4I8wpLkOw4iSIzwtyIH0oOswg9SdHNsMu7enXZliHebM4XDJzT4H2iDvWSXFepzbPYVzbOe406/ohxnC8DKDr3miPENXakBERAREQEREBERAREQFxjrj2h2l9Stwe7QpYzwxVTAnmGtB/eXZ15v27e9vd3df167w0/Vp/q2fwtQWT6sKhb0n1qjKVMS97g1o8ePLeqVw9bB0Wqi1tq+0HRj/AGFuDve4S50b4HuDggy21dqfobRs6wINfWvX9UkZx9aPuiBmTlrdxUpUZkOr1dXFzve904jPqiOZzhZDoZYTUa10mpVD6jidYDS7M8STPiT6q0mg8uLn/SOni6SSqrc+jm3K5D6lFlKgGOEuEhpykhwcSCIj2rcNoNpbUtzVo4f0qiIcBPfGuEYgCRrhPGRvWjdIWC32Xs+3YD2lw11eqeILpY3+IfdWV6J1DZOY5u70/rT6X9PAINevqcgHy+Y+fuWHuWCQYGeWfEafnmuh9O9lClXcWiGVgXt5Ge82PtQeQctAvGd05aZ+xRFGjWgd54aAYnKcuZ/BXTdrUf8AMb7/AMFaW5hxhuoB3TwOZ3aLL27cQ7wHx98IMQRTqV4gPBZIOmY4EamN/JVdpWzxRcPTAzGL0mwc894ic9fFVNt2rAwPDcMOHfbAgOMTlrqCqzO0p6ntqehIjG3dmPpD3oJKtqKlEBpMFstznmJJVOhVdUaPo5DEecblDYVPuPwkiHEYdwjQjyKhaP7M1WOMw6RO8OAKCpstkPD2ueKlN8hwc6AQQ5hAmPVOkL1FsLaTbm3pV26PaDHA6OHkQR5LytWa4vguczENRAmIyzznNdr6j9oONvWtnvLzTeHtmJDXjMZaw5rj+8EHTEREBERAREQEREBERBY7cvewtq1b/LpPf91hd8l5ptWYaTBn6Iknfv8Amu8dat12eyro+s1tP/mVGs+Dlw24ENAQYu4ctr6TWYBsrGT+pYHVANMdQY6hPhIA+0Vhejln215b0zo6q2fBpxO9wKy11QqXlW/rU5LsD3NjUtx6DngACCp0a2lG0rc/RNQtPDCWljfe4HzK1SpaGlc16MZsqPb915A90Kt0XqAVGVJ9B7T7HA+yAtm6XbN7PbVN0dy5cx3IyQyoPEET+8FVUOndP/aFpQ3UqFFv8TnH3Qtr6KWDX1w+p+zpDtHZa4fREb5dGXitV6U1Me2zwAZHlbg/GVvFrtZmz7OpVe3FUrd2mzjkcz9UAyTzHFBP0nr/AKXb1KmHC6lUxAb8JyP4n7K5ResgkbgSPbp8l1norsW6fbvubl8NrswtoxAa12j43TOQzMGSVyvaYIcZGY15RkfgojB0hBb3jvbMZjjr9lZJtmHaVLhp49oI9gaFi6pgkQcnDMTyJ035lZCiHM7wo1DI1AE+8ygludk1OzLe1c5oBwtdGUaZjw0VSw2s0wKjcDjkHfRdH1uKi7a7DLXNqNMwAQQTPMaZ81R2W0PoBrgHNzaQd0OMIJmhzLl7WQWuAc5ukbsQUtZ/+IaCIBaY5lp+Qn2qjhFGsyXHCWloJMxmCAVV2oc6bpzDsuciI+CBfOghwzcHT7iI963Pqf2rUZtOmwsAbVY9hOIZd3tG5ECc2R5rSLqh3HTm6JncCM8lk9hbWbRr0K2NowVGPkkDIOBcPZIQepkREBERAREQEREBERBofXPUjZ7Wf5lxSb7CX/6Fxy8PdHgPgusddzv8PaN43YPso1PxXJ9ooLzoMcNxVq/5NtWqDxDMI/mV30b2k60DazfXOIes0Ngj2gecK06JmKN+7hbtb/zKoHyUb5uG1p/8N7vbVbHulUZHpD0OqGqLvZ1M17e4Ac6myJbjEy0E+gZkeqZByW4XNwQ1lMsD3tA3Bxa4Nglp3HXMKw6E7QLbTsOFNrmnhpiHhJn2qytNl1m7QpXI7RzHU3jA05kg4QCCYw5l07iziWglTHYLbm8o13EsLP2jDq/D+zIPAyQeQWrdJulFOptAPew1bai8MFMEDG1rpfE5d4g+IgZarfL7ZdzXvKl1RIbQbb9g8OOGo2o0nuuZE4pfiDtMLstVxCvSIGuYI9/9kHrWjeU7m1FWiQ6nUph7CMsokZbjujcvPnTSjguqzfruP3u+P511vqd2bUpbLpio7E2qXVKY9RlQAgHxOJ3LFC5p1j0ovHH1mtP8Ab/pURody7N+e6fir20cZ0b7z8lZXLcz9kfNTUWscADvjigzzXxmMj4weSwNG3JfULHdm4PIA3O397dv3K6bYCZDntyjuuPzkKzpVDTfUbhL2zJjUZcEE91XLzTa9pBxw4bjlqDwVTatEBgcJ7pbHkY+al2o8OYx7CJDhhOvko3tw7sicMOjPgIKCpUrF8hnDMnIaaKnZ0WuYDhEx+YVUFrWt3DhxVraMc4d18NkxkJ96D1tsq57WjSqevTa77zQfmrpYDoDULtm2hOZFBjZ44W4Z9yz6AiIgIiICIiAiIg5p12/s7P/AI7v+k5cr2pquq9dw/U2Z/8Acx7aT/wXKdp6oLzoo2bbaP2Lf/rH8Fl//DF1dUKJouoimaIacZIMzJ0B5LE9E/8Ad9oAa9lSP3as/NVr3aF5ToUXUa7qdPsj3RHpMqYXR95nvVV0vYnRf9Ht8Tnh9RzW08hDWgEYonMk4RnkrgUsDgB9FoHtzPyWtdAOkteu00ar+0/Vl4cQAQWwdwGRB9qtuizLi3Nd12DFWu5zXl2IO0EiCcLcgIMRkg3e3vWtfcOe5rG1KNMkuIAxgvpzJ3kCmPILSbzq9sXS4uq08RkgPbGZnLE0xmqm1NmOvQS2WtFeiW4pAeyi5xqGNc+0dHHAOMrlO2bt9R9R76jny4wSSYl2QE6CNyD0DaOpW9vRt6N24U6bMI79PFloC4NBXN+s0f4lu+aTPPN+/wAlc/8A8+7Oa+vd1HMaWtpMbmAQS97jv+wrbrQP+Ky0FNg97z81Ec/uRnwyUKPaQILNBqDw8VG79LLhpxVGnUa0CWO8QJQXja1YES1jhG4kfGVQtKsVHgkNcYgbjA0+Cqs2gyYMjxBCt6Qa91TEMTZG7PSJjyQT7SoBoxjIY2lw3a6gK5vHg03Z5Eaj5K0usTWtaTiaXiCdY4H8VVvKI7MgZQDHmZQTW1IgBxzMZT9EKla1HCQ1uLvHOYGZn5qNGXNbOTYEDjzPJS2ddrWxOjjkMzqg9O9W7idmWs69n8HELZVrvV2P9mWnOi0/e73zWxICIiAiIgIiICIiDnvXbSmyou9S6pn2se3/AFBckvRLQeQ+C7V1v25fsquRqw03/drNn3SuLVc2Dw/ogueheb7un69pVjxbhcPmq7nB1mweq6o37363/wCtWXQ64FPaFCfRc4sPPG0tA9pCzGwtnY31bQmC2oMz9V2B8c8Id7VRsvVDb0re3fdXLmUw9uEOeQ1oaDBzPrOHsaOKze2MFNlRuIlmE1aNRkO1bu3EEAewLkvTPbAuq4t6WVrb90AaOLcifdhHKTvXQr/pJQstm2LX0jUqOYA1gIbhbAc8nk0OAA4oqToXtKq+1om6yqPloLoaX5uLRHrFjZPJc1vui5ZtFtk52Fj6zA1//p1HQ13iASPtAra+squf0uyoNJa2WuBBI71StgnLeAwQVsXSTYZu6Ic0RXpz2Z0xDIuZO46Ec/tFBuvQ7olQ2ZRqU6Lqj8bi9zqhaXZNAA7rQIAHDeVxnrDq4rt/INHspg/6l0von02bXoG3rksu2NLSHCDUgRiH1ozI8TppyLpNcdpc1Xbi90eAOEe5qiNZvTm77PyKlo1xl32+H5KheOzI45D8+anaydQ0jwQXLSDmIJhWNNpLnlhwkOiDo7Leq36KzWI8JA9gVC1cWgmMTMRniIMTzGSCe5rYw1pBa4ugjhlqD7FNtHF2REzkJ55qF26XMLIJzI5gR+KjfVDDWwRLgD+CCp2pd6Jget+ChZuaGBzoBzzPmoVqkNOEDujXcP6q42Ts8PLGAQ55a0eLyGiJ5lB6k6KW/Z2VrTOraFMHxFMT71lVLTYAABoBHsUyAiIgIiICIiAiIgxHS6y7axuqQ1fQqAeOA4ffC86WtTFSaeXy/uvUS8y3Vl2Fe4t4jsqr2tH1Q44Pa0goMRWqFj2vb6THBw8WmR7wt120/DeCrSMC6pB9M7peyP5hPmtNvGLYaVU19lhwk1bF85a9m4zP7vwplBqdrRdTJxNInLPiPyVsvT+rN3RpbqVBjY5kEn3Qr7aVqy4FGu0ftSxro3Pbx+00Zc2j1lg+l1adpV3HQOA8AGAKqynTu6lmzrrgwgnnTcx3xLl1jZDGvLqRMCoJaeBEkH3kLke1qJqbIYc/1Fwd30agMxyxOb7FvXRbaXaW1CqD3gxsng5uTveEC7oVLapXfXY3FSpktfAJdM4cL4mDERuXKrk5+AC6j1nba7RjGaY4kcA3M/xEexcouX6nxURi65nLUF3wUGW7folw8z8CoPacXdiQMwfZ8lEXJHpMI5jMIJgx7Q44p9k5f0CWLwIaZDv5pzUtevLMpkiPbqq/YggNO7QjcgpuaG1QYyiMtASfmlzD3NZ4k+ShZnvPkyZj2KBbjeSDAaIMIJrioAMIEycOWglbZ1abI7XaVqHS/A/Hno3s2l4P3mtHmtTrZFoAmDOEfnmuvdQuznOq3Fy4ABrG02+L3YnZ8QGN9qDs6IiAiIgIiICIiAiIgLhvW3s/sdpCqB3bimHeLqf6t/8ABg9q7ktD65NjmtY9s0d+2d2viyMNUeGE4v3EHF7qkrjoptQWtyC/9lUGCoDphO8+B90qFAh7R7Pw93wVvXtkGzPthZVnW9QTaVs6bychmCJO5zTGf2HLXuk9hUF0+oRIJBJyg5R7wPjwWw9HNr06lL9DvILNKbydOALtxG53DI88s3o1WYOza9talBDcXdqNB3TBa4aa5ZDIQqrUdhbdHYPsqubDiDTOgMktPgTIP9FmegOzatNznCq11tmXaRIGWUy10QSdIWQ2N0OqNDm16jXs+i4jFVAjMF2nnBVDbu1qbaYtbWBSGTnDR3IHeJ1O9Bheku0e2qvqfR9Fnh/XM+a1W7O7istfPzjh8d/4LB3j9Y8B4qIs2P1Jxa+kNMsvkq7HtIiQZy8VSa4NgGWxx0PmqjqbXbgfD8UEleC5oI4k+EclHGaYP0m7uI5KnSBxOc3ODEHfxg+KqPqB2FsHM5jQgD+qCpbs7oJ1w68jnCpWkkGBAJJn8EupDA3FwH4+5VKhIaYyAGXHkgWuEPccychGs8c/zovTPVjsc22z6QcIfV/Wv4y/0QeYYGjyXD+rbYJu7ujRwk02/rKpM+i2CRnriJDf3uS9NgICIiAiIgIiICIiAiIgKSrTDmlrgC1wIIOhBEEFTog817a2WbC8qWzpwNMsJ1dTdmw8yNDzaVUdSBC631odEf023FSkP8RRBLBl+sB9Kn5wCOY3AlcSsNo4e68GBlmO807wQfeEFetaq7sNqXNEYadZ7W8DDgPAOBA8lUY5rhIIPgmBBNd7TuKwipVc5vq5NafENAB81YV6mAc934qpc3jW7wTwWIr1y4ygpV6mRKxdf0tC6NQPOP7K7r1R5fHQfNWeLD6UgnPFqD4oI06jTofI6j25qncUmhpcBB5b50VV9NrhnBVv2UuhpPdzzzE8EFWkCwAat47x48lGj3nF40001HH2qDqp9HDDj7OZnwUaowtwtJk6Df8A2CCDCS8nUDIcOaqYJePSIaJMaTuRrYAG/c0HMnxXTep7oM6q5tzWbFCmZaDn2zwdfsNI8zA3EIOgdVPRg2lrjqtivXhzhvY36DPGCSebiNy3ZEQEREBERAREQEREBERAREQFzbrI6u/0guurUAV4l9PQVeY4P9x5HM9JRB5PfiY4tcHMc0kEGQQRkQRqCouuXHVzj4kr0L0x6DW98C4js60ZVGjWNzx9Ie8LinSfohc2Rmsw9nP7VoLqZ4S8Dukxo4NzOWQlBgMSlJ8hxVNzuY4HXX2abx4hUXunXMjdoPyYBBQSyXAGYjwyMDMjgpe0j0svDNp/BRcQTIMO95+0FI6sR6QEcvwKCSqxoEjU6YTEqNNrmDc4ancf6qRuEkudDfd5zxU+eUklu4HUnduzQRaRHaO8uQ4c1GmyJe7eNN45SVcbNsKtxUDKdJ9R+5jGlxHMgfE5BdZ6E9UTsTa20IA1FBrpP/yObkN+TSZ9YaINZ6s+gzr+t2tVrm2zMnEGMZ9Rrokn1iNBlMleh7ag2m1rGNa1jQA1rRAAGQAA0ChbW7KbWsY1rGNENa0ANAGgAGQCqoCIiAiIgIiICIiAiIgIiICIiAiIgKDmggggEHIg6FRRBpW3+q7Z9yS4U3W7z9KgQ0HxpkFnulaZtLqPqa0Lxp4CpTIP32OP8q7QiDz3V6mNp+tZO4HtKn/aVIdTG0+NrP8AxX/9teiUQcJ2d1I3bv8AeLm3YODA+p7iGD4rcti9T1hSIdV7W4cPWdhZ5NZBjkSQuiIgtNnbNo0G4KFKnSb6rGtaPYArtEQEREBERAREQEREBERAREQEREBERAREQEREBERAREQEREBERAREQEREBERAREQEREH/2Q==" alt="Vista previa">
                        <button type="button" onclick="cerrarVistaPrevia()" class="btn btn-danger btn-sm">‚ùå</button>
                    </div>
                    <small>Sube una imagen o ingresa la URL. Tama√±o m√°ximo: 5MB</small>
                </div>

                <div class="form-actions">
                    <button type="submit" class="btn btn-success">üíæ Guardar</button>
                    <button type="button" onclick="cerrarModal()" class="btn btn-secondary">Cancelar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal de confirmaci√≥n para eliminar -->
    <div id="modal-eliminar" class="modal hidden">
        <div class="modal-content">
            <h3>üóëÔ∏è Confirmar Eliminaci√≥n</h3>
            <p>¬øEst√°s seguro de que deseas eliminar este producto del inventario?</p>
            <p><strong id="producto-eliminar-nombre"></strong></p>
            <div class="form-actions">
                <button onclick="confirmarEliminacion()" class="btn btn-danger">Eliminar</button>
                <button onclick="cerrarModalEliminar()" class="btn btn-secondary">Cancelar</button>
            </div>
        </div>
    </div>

    <!-- Modal de confirmaci√≥n gen√©rico -->
    <div id="modal-confirmacion" class="modal hidden">
        <div class="modal-content">
            <h3 id="confirmacion-titulo">‚ö†Ô∏è Confirmar Acci√≥n</h3>
            <p id="confirmacion-mensaje">¬øEst√° seguro de realizar esta acci√≥n?</p>
            <div class="form-actions">
                <button id="btn-confirmar-si" class="btn btn-primary">S√≠</button>
                <button id="btn-confirmar-no" class="btn btn-secondary">No</button>
            </div>
        </div>
    </div>

    <!-- Modal de informaci√≥n gen√©rico -->
    <div id="modal-informacion" class="modal hidden">
        <div class="modal-content">
            <h3 id="informacion-titulo">‚ÑπÔ∏è Informaci√≥n</h3>
            <div id="informacion-contenido">
                <p id="informacion-mensaje"></p>
            </div>
            <div class="form-actions">
                <button id="btn-info-cerrar" class="btn btn-primary">Cerrar</button>
            </div>
        </div>
    </div>

    <!-- Modal de detalles de producto -->
    <div id="modal-detalle-producto" class="modal hidden">
        <div class="modal-content large">
            <h3 id="detalle-titulo">üìã Detalles del Producto</h3>
            <div id="detalle-contenido">
                <!-- El contenido se llenar√° din√°micamente -->
            </div>
            <div class="form-actions">
                <button onclick="cerrarModal('modal-detalle-producto')" class="btn btn-primary">Cerrar</button>
            </div>
        </div>
    </div>

    <!-- Modal para importaci√≥n masiva -->
    <div id="modal-importacion" class="modal hidden">
        <div class="modal-content large">
            <h3>üì• Importaci√≥n Masiva de Productos</h3>
            
            <div class="import-steps">
                <div class="step-indicator">
                    <div class="step active" data-step="1">
                        <span class="step-number">1</span>
                        <span class="step-title">Cargar Archivo</span>
                    </div>
                    <div class="step" data-step="2">
                        <span class="step-number">2</span>
                        <span class="step-title">Revisar Datos</span>
                    </div>
                    <div class="step" data-step="3">
                        <span class="step-number">3</span>
                        <span class="step-title">Importar</span>
                    </div>
                </div>
            </div>

            <!-- Paso 1: Selecci√≥n de archivo -->
            <div id="paso-archivo" class="import-step active">
                <div class="import-instructions">
                    <h4>üìã Instrucciones</h4>
                    <ul>
                        <li>Sube un archivo CSV o Excel (.xlsx) con los datos de los productos</li>
                        <li>El archivo debe contener las columnas: marca, modelo, medida, precio_venta, stock_actual</li>
                        <li>Puedes descargar una plantilla de ejemplo para facilitar el proceso</li>
                    </ul>
                    
                    <div class="template-download">
                        <button onclick="descargarPlantilla()" class="btn btn-outline-primary">
                            üìÑ Descargar Plantilla CSV
                        </button>
                    </div>
                </div>
                
                <div class="file-upload-zone">
                    <input type="file" id="archivo-importacion" accept=".csv,.xlsx,.xls" style="display: none;">
                    <div class="upload-area" onclick="document.getElementById('archivo-importacion').click()">
                        <div class="upload-icon">üìÅ</div>
                        <p class="upload-text">Haz clic aqu√≠ para seleccionar un archivo</p>
                        <p class="upload-hint">o arrastra y suelta tu archivo CSV/Excel aqu√≠</p>
                    </div>
                </div>
                
                <div id="archivo-seleccionado" class="file-selected" style="display: none;">
                    <div class="file-info">
                        <span class="file-icon">üìÑ</span>
                        <span id="nombre-archivo">archivo.csv</span>
                        <span id="tama√±o-archivo">1.2 KB</span>
                    </div>
                    <button onclick="quitarArchivo()" class="btn btn-sm btn-danger">‚ùå</button>
                </div>
            </div>

            <!-- Paso 2: Preview de datos -->
            <div id="paso-preview" class="import-step" style="display: none;">
                <div class="preview-info">
                    <h4>üìä Vista Previa de Datos</h4>
                    <p>Revisa los datos antes de importar. Los productos con errores ser√°n marcados en rojo.</p>
                </div>
                
                <div class="preview-stats">
                    <div class="stat-item">
                        <span class="stat-number" id="total-filas">0</span>
                        <span class="stat-label">Total Filas</span>
                    </div>
                    <div class="stat-item success">
                        <span class="stat-number" id="filas-validas">0</span>
                        <span class="stat-label">V√°lidas</span>
                    </div>
                    <div class="stat-item error">
                        <span class="stat-number" id="filas-error">0</span>
                        <span class="stat-label">Con Errores</span>
                    </div>
                </div>
                
                <div class="preview-table-container">
                    <table id="tabla-preview" class="preview-table">
                        <thead id="tabla-preview-head">
                            <!-- Se llenar√° din√°micamente -->
                        </thead>
                        <tbody id="tabla-preview-body">
                            <!-- Se llenar√° din√°micamente -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Paso 3: Progreso de importaci√≥n -->
            <div id="paso-importacion" class="import-step" style="display: none;">
                <div class="import-progress">
                    <h4>‚öôÔ∏è Importando Productos</h4>
                    <div class="progress-bar">
                        <div id="progress-fill" class="progress-fill"></div>
                    </div>
                    <p id="progress-text">Procesando productos...</p>
                    <div id="import-results" style="display: none;">
                        <h5>‚úÖ Importaci√≥n Completada</h5>
                        <ul id="results-list"></ul>
                    </div>
                </div>
            </div>

            <div class="form-actions">
                <button onclick="cerrarModal('modal-importacion')" class="btn btn-secondary">Cancelar</button>
                <button id="btn-siguiente-paso" onclick="siguientePaso()" class="btn btn-primary" disabled>
                    Siguiente
                </button>
                <button id="btn-anterior-paso" onclick="anteriorPaso()" class="btn btn-secondary" style="display: none;">
                    Anterior
                </button>
                <button id="btn-importar" onclick="ejecutarImportacion()" class="btn btn-success" style="display: none;">
                    üöÄ Importar Productos
                </button>
                <button id="btn-cerrar-importacion" onclick="cerrarModal('modal-importacion')" class="btn btn-primary" style="display: none;">
                    ‚úÖ Cerrar
                </button>
            </div>
        </div>
    </div>

    <!-- Modal para Movimientos de Inventario -->
    <div id="modal-movimientos" class="modal hidden">
        <div class="modal-content large">
            <h3>üìä Movimientos de Inventario</h3>
            
            <div class="movimientos-controls">
                <button onclick="mostrarFormularioMovimiento()" class="btn btn-primary">
                    ‚ûï Registrar Movimiento
                </button>
                <div class="filter-group">
                    <select id="filtro-tipo-movimiento">
                        <option value="">Todos los tipos</option>
                        <option value="entrada">Entradas</option>
                        <option value="salida">Salidas</option>
                        <option value="ajuste">Ajustes</option>
                        <option value="devolucion">Devoluciones</option>
                    </select>
                    <input type="date" id="fecha-desde" class="date-filter">
                    <input type="date" id="fecha-hasta" class="date-filter">
                    <button onclick="filtrarMovimientos()" class="btn btn-secondary btn-sm">Filtrar</button>
                </div>
            </div>

            <div class="tabla-movimientos">
                <table class="inventory-table">
                    <thead>
                        <tr>
                            <th>Fecha</th>
                            <th>Producto</th>
                            <th>Tipo</th>
                            <th>Cantidad</th>
                            <th>Motivo</th>
                            <th>Usuario</th>
                            <th>Stock Anterior</th>
                            <th>Stock Actual</th>
                        </tr>
                    </thead>
                    <tbody id="tabla-movimientos-body">
                        <!-- Movimientos din√°micos -->
                    </tbody>
                </table>
            </div>

            <div class="form-actions">
                <button onclick="cerrarModal('modal-movimientos')" class="btn btn-secondary">Cerrar</button>
            </div>
        </div>
    </div>

    <!-- Modal para Registro de Movimiento -->
    <div id="modal-movimiento" class="modal hidden">
        <div class="modal-content">
            <h3 id="titulo-modal-movimiento">üìù Registrar Movimiento</h3>
            <div id="form-movimiento-errors" class="form-errors hidden"></div>
            <form id="form-movimiento">
                <div class="form-group">
                    <label for="movimiento-producto">Producto*</label>
                    <select id="movimiento-producto" name="producto_id" required>
                        <option value="">Seleccionar producto</option>
                        <!-- Se llenar√°n din√°micamente -->
                    </select>
                </div>

                <div class="form-group">
                    <label for="movimiento-tipo">Tipo de Movimiento*</label>
                    <select id="movimiento-tipo" name="tipo" required onchange="actualizarTipoMovimiento()">
                        <option value="">Seleccionar tipo</option>
                        <option value="entrada">üìà Entrada - Aumentar stock</option>
                        <option value="salida">üìâ Salida - Reducir stock</option>
                        <option value="ajuste">‚öñÔ∏è Ajuste - Correcci√≥n</option>
                        <option value="devolucion">üîÑ Devoluci√≥n</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="movimiento-cantidad">Cantidad*</label>
                    <input type="number" id="movimiento-cantidad" name="cantidad" 
                           required min="1" placeholder="Ej: 5">
                    <small id="stock-actual-info">Stock actual: -</small>
                </div>

                <div class="form-group">
                    <label for="movimiento-motivo">Motivo*</label>
                    <select id="movimiento-motivo" name="motivo" required>
                        <option value="">Seleccionar motivo</option>
                        <!-- Se llenar√°n seg√∫n el tipo -->
                    </select>
                </div>

                <div class="form-group">
                    <label for="movimiento-observaciones">Observaciones</label>
                    <textarea id="movimiento-observaciones" name="observaciones" rows="3"
                              placeholder="Detalles adicionales del movimiento..."></textarea>
                </div>

                <div class="form-group">
                    <label for="movimiento-documento">Documento de Referencia</label>
                    <input type="text" id="movimiento-documento" name="documento_referencia" 
                           placeholder="Ej: Factura #001, Orden #123">
                </div>

                <div class="form-actions">
                    <button type="submit" class="btn btn-success">üíæ Registrar Movimiento</button>
                    <button type="button" onclick="cerrarModal('modal-movimiento')" class="btn btn-secondary">Cancelar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal para Inventario F√≠sico -->
    <div id="modal-inventario-fisico" class="modal hidden">
        <div class="modal-content large">
            <h3>üìã Inventario F√≠sico vs Sistema</h3>
            
            <div class="inventario-fisico-info">
                <div class="info-card">
                    <h4>¬øQu√© es el Inventario F√≠sico?</h4>
                    <p>El inventario f√≠sico es el recuento real de productos en el almac√©n. 
                    Comp√°ralo con el sistema para detectar diferencias y realizar ajustes.</p>
                </div>
            </div>

            <div class="inventario-fisico-controls">
                <button onclick="iniciarInventarioFisico()" class="btn btn-primary">
                    üéØ Iniciar Conteo F√≠sico
                </button>
                <button onclick="exportarInventarioFisico()" class="btn btn-info">
                    üìä Exportar Lista de Conteo
                </button>
                <button onclick="mostrarHistorialInventarios()" class="btn btn-secondary">
                    üìà Historial de Inventarios
                </button>
            </div>

            <div id="conteo-fisico-container" style="display: none;">
                <h4>üìù Registro de Conteo F√≠sico</h4>
                <div class="conteo-progress">
                    <div class="progress-info">
                        <span>Progreso: <span id="productos-contados">0</span> de <span id="total-productos-contar">0</span> productos</span>
                        <div class="progress-bar">
                            <div id="progress-conteo" class="progress-fill" style="width: 0%;"></div>
                        </div>
                    </div>
                </div>

                <div class="conteo-table">
                    <table class="inventory-table">
                        <thead>
                            <tr>
                                <th>Producto</th>
                                <th>Ubicaci√≥n</th>
                                <th>Stock Sistema</th>
                                <th>Conteo F√≠sico</th>
                                <th>Diferencia</th>
                                <th>Estado</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="tabla-conteo-fisico">
                            <!-- Se llena din√°micamente -->
                        </tbody>
                    </table>
                </div>

                <div class="conteo-acciones">
                    <button onclick="finalizarInventarioFisico()" class="btn btn-success">
                        ‚úÖ Finalizar y Aplicar Ajustes
                    </button>
                    <button onclick="cancelarInventarioFisico()" class="btn btn-danger">
                        ‚ùå Cancelar Conteo
                    </button>
                </div>
            </div>

            <div class="form-actions">
                <button onclick="cerrarModal('modal-inventario-fisico')" class="btn btn-secondary">Cerrar</button>
            </div>
        </div>
    </div>


    <!-- Modal para Reservas de Stock -->
    <div id="modal-reservas" class="modal hidden">
        <div class="modal-content large">
            <h3>üîí Reservas de Stock</h3>
            
            <div class="reservas-controls">
                <button onclick="mostrarFormularioReserva()" class="btn btn-primary">
                    ‚ûï Nueva Reserva
                </button>
                <div class="filter-group">
                    <select id="filtro-estado-reserva">
                        <option value="">Todos los estados</option>
                        <option value="activa">Activas</option>
                        <option value="parcial">Parcialmente usadas</option>
                        <option value="completada">Completadas</option>
                        <option value="vencida">Vencidas</option>
                        <option value="cancelada">Canceladas</option>
                    </select>
                    <input type="date" id="fecha-vencimiento-filtro" class="date-filter" placeholder="Fecha l√≠mite">
                    <button onclick="filtrarReservas()" class="btn btn-secondary btn-sm">Filtrar</button>
                </div>
            </div>

            <div class="reservas-estadisticas">
                <div class="stat-card">
                    <h4 id="total-reservas">0</h4>
                    <p>Total Reservas</p>
                </div>
                <div class="stat-card warning">
                    <h4 id="reservas-vencidas">0</h4>
                    <p>Vencidas</p>
                </div>
                <div class="stat-card success">
                    <h4 id="productos-reservados">0</h4>
                    <p>Productos Reservados</p>
                </div>
            </div>

            <div class="tabla-reservas">
                <table class="inventory-table">
                    <thead>
                        <tr>
                            <th>ID Reserva</th>
                            <th>Producto</th>
                            <th>Cliente/Cotizaci√≥n</th>
                            <th>Cantidad</th>
                            <th>Usado</th>
                            <th>Disponible</th>
                            <th>Fecha L√≠mite</th>
                            <th>Estado</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody id="tabla-reservas-body">
                        <!-- Reservas din√°micas -->
                    </tbody>
                </table>
            </div>

            <div class="form-actions">
                <button onclick="cerrarModal('modal-reservas')" class="btn btn-secondary">Cerrar</button>
            </div>
        </div>
    </div>

    <!-- Modal para Nueva Reserva -->
    <div id="modal-nueva-reserva" class="modal hidden">
        <div class="modal-content">
            <h3>üîí Nueva Reserva de Stock</h3>
            <div id="form-reserva-errors" class="form-errors hidden"></div>
            <form id="form-reserva">
                <div class="form-group">
                    <label for="reserva-producto">Producto*</label>
                    <select id="reserva-producto" name="producto_id" required>
                        <option value="">Seleccionar producto</option>
                        <!-- Se llenar√°n din√°micamente -->
                    </select>
                </div>

                <div class="form-group">
                    <label for="reserva-cantidad">Cantidad a Reservar*</label>
                    <input type="number" id="reserva-cantidad" name="cantidad" 
                           required min="1" placeholder="Ej: 4">
                    <small id="stock-disponible-info">Stock disponible: -</small>
                </div>

                <div class="form-group">
                    <label for="reserva-cliente">Cliente/Empresa</label>
                    <input type="text" id="reserva-cliente" name="cliente" 
                           placeholder="Nombre del cliente o empresa">
                </div>

                <div class="form-group">
                    <label for="reserva-cotizacion">ID Cotizaci√≥n</label>
                    <input type="text" id="reserva-cotizacion" name="cotizacion_id" 
                           placeholder="Ej: COT-2024-001">
                </div>

                <div class="form-group">
                    <label for="reserva-fecha-limite">Fecha L√≠mite*</label>
                    <input type="date" id="reserva-fecha-limite" name="fecha_limite" required>
                    <small>Fecha hasta la cual la reserva estar√° activa</small>
                </div>

                <div class="form-group">
                    <label for="reserva-observaciones">Observaciones</label>
                    <textarea id="reserva-observaciones" name="observaciones" rows="3"
                              placeholder="Detalles de la reserva..."></textarea>
                </div>

                <div class="form-actions">
                    <button type="submit" class="btn btn-success">üîí Crear Reserva</button>
                    <button type="button" onclick="cerrarModal('modal-nueva-reserva')" class="btn btn-secondary">Cancelar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal para Gestionar Reserva -->
    <div id="modal-gestionar-reserva" class="modal hidden">
        <div class="modal-content">
            <h3 id="titulo-gestionar-reserva">üîí Gestionar Reserva</h3>
            
            <div class="reserva-detalle">
                <div class="detalle-grid">
                    <div class="detalle-item">
                        <strong>Producto:</strong>
                        <span id="detalle-producto">-</span>
                    </div>
                    <div class="detalle-item">
                        <strong>Cliente:</strong>
                        <span id="detalle-cliente">-</span>
                    </div>
                    <div class="detalle-item">
                        <strong>Cantidad Reservada:</strong>
                        <span id="detalle-cantidad-reservada">-</span>
                    </div>
                    <div class="detalle-item">
                        <strong>Cantidad Usada:</strong>
                        <span id="detalle-cantidad-usada">-</span>
                    </div>
                    <div class="detalle-item">
                        <strong>Cantidad Disponible:</strong>
                        <span id="detalle-cantidad-disponible">-</span>
                    </div>
                    <div class="detalle-item">
                        <strong>Fecha L√≠mite:</strong>
                        <span id="detalle-fecha-limite">-</span>
                    </div>
                </div>
            </div>

            <div class="reserva-acciones">
                <h4>Acciones Disponibles</h4>
                
                <div class="accion-grupo">
                    <h5>Usar Stock Reservado</h5>
                    <div class="form-group">
                        <input type="number" id="cantidad-usar" placeholder="Cantidad a usar" min="1">
                        <button onclick="usarStockReservado()" class="btn btn-primary btn-sm">
                            ‚úÖ Usar Stock
                        </button>
                    </div>
                </div>

                <div class="accion-grupo">
                    <h5>Modificar Reserva</h5>
                    <div class="form-group">
                        <input type="date" id="nueva-fecha-limite" placeholder="Nueva fecha l√≠mite">
                        <button onclick="modificarFechaLimite()" class="btn btn-warning btn-sm">
                            üìÖ Modificar Fecha
                        </button>
                    </div>
                </div>

                <div class="accion-grupo">
                    <h5>Finalizar Reserva</h5>
                    <button onclick="liberarReserva()" class="btn btn-info">
                        üîì Liberar Stock
                    </button>
                    <button onclick="cancelarReserva()" class="btn btn-danger">
                        ‚ùå Cancelar Reserva
                    </button>
                </div>
            </div>

            <div class="form-actions">
                <button onclick="cerrarModal('modal-gestionar-reserva')" class="btn btn-secondary">Cerrar</button>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/jsbarcode@3.11.5/dist/JsBarcode.all.min.js"></script>
    <script src="/js/utils.js"></script>
    <script src="/js/admin-inventario.js"></script>
    <script>
        // Inicializar footer unificado
        document.addEventListener('DOMContentLoaded', function() {
            renderFooter({ type: 'dashboard' });
        });
    </script>
</body>
</html>